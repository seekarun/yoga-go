{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.231.0"},"children":{"YogaGoStack":{"id":"YogaGoStack","path":"YogaGoStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.231.0"},"children":{"YogaGoUserPool":{"id":"YogaGoUserPool","path":"YogaGoStack/YogaGoUserPool","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPool","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/YogaGoUserPool/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPool","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPool","aws:cdk:cloudformation:props":{"accountRecoverySetting":{"recoveryMechanisms":[{"name":"verified_email","priority":1}]},"adminCreateUserConfig":{"allowAdminCreateUserOnly":false},"autoVerifiedAttributes":["email"],"emailConfiguration":{"from":"MyYoga.Guru <noreply@myyoga.guru>","emailSendingAccount":"DEVELOPER","sourceArn":"arn:aws:ses:us-west-2:710735877057:identity/myyoga.guru"},"emailVerificationMessage":"Namaste! Please verify your email by entering this code: {####}","emailVerificationSubject":"Verify your MyYoga.Guru account","enabledMfas":["SOFTWARE_TOKEN_MFA"],"mfaConfiguration":"OPTIONAL","policies":{"passwordPolicy":{"minimumLength":8,"requireLowercase":true,"requireUppercase":true,"requireNumbers":true,"requireSymbols":false}},"schema":[{"name":"email","mutable":true,"required":true},{"name":"name","mutable":true,"required":false}],"smsVerificationMessage":"The verification code to your new account is {####}","usernameAttributes":["email"],"userPoolName":"yoga-go-users","verificationMessageTemplate":{"defaultEmailOption":"CONFIRM_WITH_CODE","emailMessage":"Namaste! Please verify your email by entering this code: {####}","emailSubject":"Verify your MyYoga.Guru account","smsMessage":"The verification code to your new account is {####}"}}}},"CognitoCustomDomain":{"id":"CognitoCustomDomain","path":"YogaGoStack/YogaGoUserPool/CognitoCustomDomain","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolDomain","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/YogaGoUserPool/CognitoCustomDomain/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolDomain","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolDomain","aws:cdk:cloudformation:props":{"customDomainConfig":{"certificateArn":"placeholder"},"domain":"auth.myyoga.guru","userPoolId":{"Ref":"YogaGoUserPool95F58773"}}}}}},"YogaGoWebClient":{"id":"YogaGoWebClient","path":"YogaGoStack/YogaGoUserPool/YogaGoWebClient","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolClient","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/YogaGoUserPool/YogaGoWebClient/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolClient","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolClient","aws:cdk:cloudformation:props":{"allowedOAuthFlows":["code"],"allowedOAuthFlowsUserPoolClient":true,"allowedOAuthScopes":["email","openid","profile"],"callbackUrLs":["http://localhost:3111/api/auth/callback/cognito","https://myyoga.guru/api/auth/callback/cognito","https://www.myyoga.guru/api/auth/callback/cognito","http://localhost:3111/api/auth/google/callback","https://myyoga.guru/api/auth/google/callback","https://www.myyoga.guru/api/auth/google/callback","http://localhost:3111/api/auth/facebook/callback","https://myyoga.guru/api/auth/facebook/callback","https://www.myyoga.guru/api/auth/facebook/callback"],"clientName":"yoga-go-web","explicitAuthFlows":["ALLOW_USER_PASSWORD_AUTH","ALLOW_USER_SRP_AUTH","ALLOW_REFRESH_TOKEN_AUTH"],"generateSecret":true,"logoutUrLs":["http://localhost:3111","https://myyoga.guru","https://www.myyoga.guru"],"preventUserExistenceErrors":"ENABLED","supportedIdentityProviders":["COGNITO","Google","Facebook"],"userPoolId":{"Ref":"YogaGoUserPool95F58773"}}}}}}}},"CognitoCertificate":{"id":"CognitoCertificate","path":"YogaGoStack/CognitoCertificate","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"CognitoCloudFrontDomain":{"id":"CognitoCloudFrontDomain","path":"YogaGoStack/CognitoCloudFrontDomain","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"AppSecretEnsureExists":{"id":"AppSecretEnsureExists","path":"YogaGoStack/AppSecretEnsureExists","constructInfo":{"fqn":"aws-cdk-lib.custom_resources.AwsCustomResource","version":"2.231.0"},"children":{"Provider":{"id":"Provider","path":"YogaGoStack/AppSecretEnsureExists/Provider","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.SingletonFunction","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"YogaGoStack/AppSecretEnsureExists/Resource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.231.0","metadata":[]},"children":{"Default":{"id":"Default","path":"YogaGoStack/AppSecretEnsureExists/Resource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.231.0"}}}},"CustomResourcePolicy":{"id":"CustomResourcePolicy","path":"YogaGoStack/AppSecretEnsureExists/CustomResourcePolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/AppSecretEnsureExists/CustomResourcePolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"secretsmanager:CreateSecret","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"AppSecretEnsureExistsCustomResourcePolicyFED3A97B","roles":[{"Ref":"AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2"}]}}}}}}},"AWS679f53fac002430cb0da5b7982bd2287":{"id":"AWS679f53fac002430cb0da5b7982bd2287","path":"YogaGoStack/AWS679f53fac002430cb0da5b7982bd2287","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.231.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"YogaGoStack/AWS679f53fac002430cb0da5b7982bd2287/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.231.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"YogaGoStack/AWS679f53fac002430cb0da5b7982bd2287/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"YogaGoStack/AWS679f53fac002430cb0da5b7982bd2287/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Code":{"id":"Code","path":"YogaGoStack/AWS679f53fac002430cb0da5b7982bd2287/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.231.0"},"children":{"Stage":{"id":"Stage","path":"YogaGoStack/AWS679f53fac002430cb0da5b7982bd2287/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.231.0"}},"AssetBucket":{"id":"AssetBucket","path":"YogaGoStack/AWS679f53fac002430cb0da5b7982bd2287/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.231.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"YogaGoStack/AWS679f53fac002430cb0da5b7982bd2287/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-710735877057-ap-southeast-2","s3Key":"bc8ef58951f4c88e641dd23090e9d2e2e61c7530a07960e767522941e959b625.zip"},"handler":"index.handler","role":{"Fn::GetAtt":["AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2","Arn"]},"runtime":"nodejs22.x","timeout":120}}}}},"AppSecret":{"id":"AppSecret","path":"YogaGoStack/AppSecret","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"GoogleProvider":{"id":"GoogleProvider","path":"YogaGoStack/GoogleProvider","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolIdentityProviderGoogle","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/GoogleProvider/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolIdentityProvider","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolIdentityProvider","aws:cdk:cloudformation:props":{"attributeMapping":{"email":"email","name":"name","picture":"picture"},"providerDetails":{"client_id":"{{resolve:secretsmanager:arn:aws:secretsmanager:ap-southeast-2:710735877057:secret:yoga-go/production:SecretString:GOOGLE_CLIENT_ID::}}","client_secret":"{{resolve:secretsmanager:arn:aws:secretsmanager:ap-southeast-2:710735877057:secret:yoga-go/production:SecretString:GOOGLE_CLIENT_SECRET::}}","authorize_scopes":"email profile openid"},"providerName":"Google","providerType":"Google","userPoolId":{"Ref":"YogaGoUserPool95F58773"}}}}}},"FacebookProvider":{"id":"FacebookProvider","path":"YogaGoStack/FacebookProvider","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolIdentityProviderFacebook","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/FacebookProvider/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolIdentityProvider","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolIdentityProvider","aws:cdk:cloudformation:props":{"attributeMapping":{"email":"email","name":"name"},"providerDetails":{"client_id":"{{resolve:secretsmanager:arn:aws:secretsmanager:ap-southeast-2:710735877057:secret:yoga-go/production:SecretString:FACEBOOK_APP_ID::}}","client_secret":"{{resolve:secretsmanager:arn:aws:secretsmanager:ap-southeast-2:710735877057:secret:yoga-go/production:SecretString:FACEBOOK_APP_SECRET::}}","authorize_scopes":"email,public_profile"},"providerName":"Facebook","providerType":"Facebook","userPoolId":{"Ref":"YogaGoUserPool95F58773"}}}}}},"EmailIdentity":{"id":"EmailIdentity","path":"YogaGoStack/EmailIdentity","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.EmailIdentity","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/EmailIdentity/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnEmailIdentity","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::EmailIdentity","aws:cdk:cloudformation:props":{"emailIdentity":"myyoga.guru","mailFromAttributes":{"mailFromDomain":"mail.myyoga.guru"}}}}}},"SesConfigSet":{"id":"SesConfigSet","path":"YogaGoStack/SesConfigSet","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.ConfigurationSet","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/SesConfigSet/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnConfigurationSet","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::ConfigurationSet","aws:cdk:cloudformation:props":{"name":"yoga-go-emails","reputationOptions":{"reputationMetricsEnabled":true},"sendingOptions":{"sendingEnabled":true}}}},"CloudWatchDestination":{"id":"CloudWatchDestination","path":"YogaGoStack/SesConfigSet/CloudWatchDestination","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.ConfigurationSetEventDestination","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/SesConfigSet/CloudWatchDestination/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnConfigurationSetEventDestination","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::ConfigurationSetEventDestination","aws:cdk:cloudformation:props":{"configurationSetName":{"Ref":"SesConfigSetECAFDFF8"},"eventDestination":{"enabled":true,"matchingEventTypes":["send","delivery","bounce","complaint","reject","open","click"],"cloudWatchDestination":{"dimensionConfigurations":[{"dimensionValueSource":"messageTag","dimensionName":"EmailType","defaultDimensionValue":"transactional"}]}}}}}}},"BounceNotificationDestination":{"id":"BounceNotificationDestination","path":"YogaGoStack/SesConfigSet/BounceNotificationDestination","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.ConfigurationSetEventDestination","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/SesConfigSet/BounceNotificationDestination/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnConfigurationSetEventDestination","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::ConfigurationSetEventDestination","aws:cdk:cloudformation:props":{"configurationSetName":{"Ref":"SesConfigSetECAFDFF8"},"eventDestination":{"enabled":true,"matchingEventTypes":["bounce","complaint"],"snsDestination":{"topicArn":{"Ref":"SesBounceNotificationTopic0C5D5AD9"}}}}}}}}}},"WelcomeEmailTemplate":{"id":"WelcomeEmailTemplate","path":"YogaGoStack/WelcomeEmailTemplate","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnTemplate","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::Template","aws:cdk:cloudformation:props":{"template":{"templateName":"yoga-go-welcome","subjectPart":"Welcome to MyYoga.Guru! ðŸ§˜","textPart":"Hi {{name}},\n\nWelcome to MyYoga.Guru!\n\nWe're thrilled to have you join our community of yoga enthusiasts.\n\nNamaste,\nThe MyYoga.Guru Team","htmlPart":"<!DOCTYPE html>\n<html><body style=\"font-family: sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n<h1 style=\"color: #6366f1;\">ðŸ§˜ MyYoga.Guru</h1>\n<h2>Hi {{name}}!</h2>\n<p>Welcome to <strong>MyYoga.Guru</strong>!</p>\n<p>We're thrilled to have you join our community of yoga enthusiasts.</p>\n<div style=\"text-align: center; margin: 30px 0;\">\n<a href=\"https://www.myyoga.guru/app\" style=\"background-color: #6366f1; color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px;\">Start Exploring</a>\n</div>\n<p><strong>Namaste,</strong><br>The MyYoga.Guru Team</p>\n</body></html>"}}}},"InvoiceEmailTemplate":{"id":"InvoiceEmailTemplate","path":"YogaGoStack/InvoiceEmailTemplate","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnTemplate","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::Template","aws:cdk:cloudformation:props":{"template":{"templateName":"yoga-go-invoice","subjectPart":"Payment Confirmation - Order #{{orderId}} ðŸ§˜","textPart":"Hi {{customerName}},\n\nThank you for your purchase!\n\nOrder ID: {{orderId}}\nAmount: {{currency}} {{amount}}\nStatus: PAID\n\nNamaste,\nThe MyYoga.Guru Team","htmlPart":"<!DOCTYPE html>\n<html><body style=\"font-family: sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n<h1 style=\"color: #6366f1;\">ðŸ§˜ MyYoga.Guru - Payment Confirmation</h1>\n<p>Hi <strong>{{customerName}}</strong>,</p>\n<p>Thank you for your purchase!</p>\n<div style=\"background: #f3f4f6; padding: 20px; border-radius: 8px; margin: 20px 0;\">\n<p><strong>Order ID:</strong> {{orderId}}</p>\n<p><strong>Amount:</strong> {{currency}} {{amount}}</p>\n<p><strong>Status:</strong> <span style=\"color: #16a34a;\">PAID</span></p>\n</div>\n<p><strong>Namaste,</strong><br>The MyYoga.Guru Team</p>\n</body></html>"}}}},"CoreTable":{"id":"CoreTable","path":"YogaGoStack/CoreTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/CoreTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"GSI1PK","attributeType":"S"},{"attributeName":"GSI1SK","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"GSI1","keySchema":[{"attributeName":"GSI1PK","keyType":"HASH"},{"attributeName":"GSI1SK","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":false},"streamSpecification":{"streamViewType":"NEW_IMAGE"},"tableName":"yoga-go-core"}}},"ScalingRole":{"id":"ScalingRole","path":"YogaGoStack/CoreTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}}}},"UsersTable":{"id":"UsersTable","path":"YogaGoStack/UsersTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/UsersTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":false},"streamSpecification":{"streamViewType":"NEW_IMAGE"},"tableName":"yoga-go-users"}}},"ScalingRole":{"id":"ScalingRole","path":"YogaGoStack/UsersTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}}}},"UserWelcomeStreamLambda":{"id":"UserWelcomeStreamLambda","path":"YogaGoStack/UserWelcomeStreamLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.231.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"YogaGoStack/UserWelcomeStreamLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.231.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"YogaGoStack/UserWelcomeStreamLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"YogaGoStack/UserWelcomeStreamLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"YogaGoStack/UserWelcomeStreamLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/UserWelcomeStreamLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:ConditionCheckItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},"/index/*"]]}]},{"Action":["ses:SendEmail","ses:SendRawEmail","ses:SendTemplatedEmail"],"Condition":{"StringLike":{"ses:FromAddress":"*@myyoga.guru"}},"Effect":"Allow","Resource":"*"},{"Action":"dynamodb:ListStreams","Effect":"Allow","Resource":"*"},{"Action":["dynamodb:DescribeStream","dynamodb:GetRecords","dynamodb:GetShardIterator"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CoreTable97EB8292","StreamArn"]},{"Fn::GetAtt":["UsersTable9725E9C8","StreamArn"]}]},{"Action":["dynamodb:BatchWriteItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:PutItem","dynamodb:UpdateItem"],"Effect":"Allow","Resource":{"Fn::GetAtt":["AnalyticsTable3F84C304","Arn"]}}],"Version":"2012-10-17"},"policyName":"UserWelcomeStreamLambdaServiceRoleDefaultPolicy1DE0AECE","roles":[{"Ref":"UserWelcomeStreamLambdaServiceRole8623F1EF"}]}}}}}}},"Code":{"id":"Code","path":"YogaGoStack/UserWelcomeStreamLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.231.0"},"children":{"Stage":{"id":"Stage","path":"YogaGoStack/UserWelcomeStreamLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.231.0"}},"AssetBucket":{"id":"AssetBucket","path":"YogaGoStack/UserWelcomeStreamLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.231.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"YogaGoStack/UserWelcomeStreamLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-710735877057-ap-southeast-2","s3Key":"56a4a5c820dad095418e510133b5f471c7d11c064b02edff8b234e65836d3a4b.zip"},"environment":{"variables":{"DYNAMODB_TABLE":{"Ref":"CoreTable97EB8292"},"USERS_TABLE":{"Ref":"UsersTable9725E9C8"},"ANALYTICS_TABLE":"yoga-go-analytics","SES_FROM_EMAIL":"hi@myyoga.guru","APP_DOMAIN":"myyoga.guru","SES_CONFIG_SET":"yoga-go-emails-west"}},"functionName":"yoga-go-user-welcome-stream","handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["UserWelcomeStreamLambdaServiceRole8623F1EF","Arn"]},"runtime":"nodejs22.x","timeout":30}}},"DynamoDBEventSource:YogaGoStackUsersTableC1D5F3C6":{"id":"DynamoDBEventSource:YogaGoStackUsersTableC1D5F3C6","path":"YogaGoStack/UserWelcomeStreamLambda/DynamoDBEventSource:YogaGoStackUsersTableC1D5F3C6","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/UserWelcomeStreamLambda/DynamoDBEventSource:YogaGoStackUsersTableC1D5F3C6/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":10,"eventSourceArn":{"Fn::GetAtt":["UsersTable9725E9C8","StreamArn"]},"filterCriteria":{"filters":[{"pattern":"{\"eventName\":[\"INSERT\"],\"dynamodb\":{\"Keys\":{\"SK\":{\"S\":[\"PROFILE\"]}}}}"}]},"functionName":{"Ref":"UserWelcomeStreamLambda6E3D36D0"},"maximumRetryAttempts":2,"startingPosition":"LATEST"}}}}},"DynamoDBEventSource:YogaGoStackCoreTable27E5B570":{"id":"DynamoDBEventSource:YogaGoStackCoreTable27E5B570","path":"YogaGoStack/UserWelcomeStreamLambda/DynamoDBEventSource:YogaGoStackCoreTable27E5B570","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/UserWelcomeStreamLambda/DynamoDBEventSource:YogaGoStackCoreTable27E5B570/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":10,"eventSourceArn":{"Fn::GetAtt":["CoreTable97EB8292","StreamArn"]},"filterCriteria":{"filters":[{"pattern":"{\"eventName\":[\"INSERT\"],\"dynamodb\":{\"NewImage\":{\"entityType\":{\"S\":[\"TENANT\"]}}}}"}]},"functionName":{"Ref":"UserWelcomeStreamLambda6E3D36D0"},"maximumRetryAttempts":2,"startingPosition":"LATEST"}}}}}}},"SurveyResponseValidatorLambda":{"id":"SurveyResponseValidatorLambda","path":"YogaGoStack/SurveyResponseValidatorLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.231.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"YogaGoStack/SurveyResponseValidatorLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.231.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"YogaGoStack/SurveyResponseValidatorLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"YogaGoStack/SurveyResponseValidatorLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"YogaGoStack/SurveyResponseValidatorLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/SurveyResponseValidatorLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},"/index/*"]]}]},{"Action":["ses:SendEmail","ses:SendRawEmail"],"Condition":{"StringLike":{"ses:FromAddress":"*@myyoga.guru"}},"Effect":"Allow","Resource":"*"},{"Action":"dynamodb:ListStreams","Effect":"Allow","Resource":"*"},{"Action":["dynamodb:DescribeStream","dynamodb:GetRecords","dynamodb:GetShardIterator"],"Effect":"Allow","Resource":{"Fn::GetAtt":["CoreTable97EB8292","StreamArn"]}},{"Action":["dynamodb:BatchGetItem","dynamodb:ConditionCheckItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["EmailsTableF5BA4582","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["EmailsTableF5BA4582","Arn"]},"/index/*"]]}]}],"Version":"2012-10-17"},"policyName":"SurveyResponseValidatorLambdaServiceRoleDefaultPolicy0637C14C","roles":[{"Ref":"SurveyResponseValidatorLambdaServiceRole708E34ED"}]}}}}}}},"Code":{"id":"Code","path":"YogaGoStack/SurveyResponseValidatorLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.231.0"},"children":{"Stage":{"id":"Stage","path":"YogaGoStack/SurveyResponseValidatorLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.231.0"}},"AssetBucket":{"id":"AssetBucket","path":"YogaGoStack/SurveyResponseValidatorLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.231.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"YogaGoStack/SurveyResponseValidatorLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-710735877057-ap-southeast-2","s3Key":"714b457a6a96fcea891c2e82ce4d71adf8f460684ffec8065a58b079982404b6.zip"},"environment":{"variables":{"DYNAMODB_TABLE":{"Ref":"CoreTable97EB8292"},"EMAILS_TABLE":"yoga-go-emails","SES_FROM_EMAIL":"verify@myyoga.guru","SES_CONFIG_SET":"yoga-go-emails-west","DEBOUNCE_API_KEY":"{{resolve:secretsmanager:arn:aws:secretsmanager:ap-southeast-2:710735877057:secret:yoga-go/production:SecretString:DEBOUNCE_API_KEY::}}"}},"functionName":"yoga-go-survey-response-validator","handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["SurveyResponseValidatorLambdaServiceRole708E34ED","Arn"]},"runtime":"nodejs22.x","timeout":30}}},"DynamoDBEventSource:YogaGoStackCoreTable27E5B570":{"id":"DynamoDBEventSource:YogaGoStackCoreTable27E5B570","path":"YogaGoStack/SurveyResponseValidatorLambda/DynamoDBEventSource:YogaGoStackCoreTable27E5B570","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/SurveyResponseValidatorLambda/DynamoDBEventSource:YogaGoStackCoreTable27E5B570/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":10,"eventSourceArn":{"Fn::GetAtt":["CoreTable97EB8292","StreamArn"]},"filterCriteria":{"filters":[{"pattern":"{\"eventName\":[\"INSERT\"],\"dynamodb\":{\"Keys\":{\"SK\":{\"S\":[{\"prefix\":\"SURVEYRESP#\"}]}}}}"}]},"functionName":{"Ref":"SurveyResponseValidatorLambdaCF325B31"},"maximumRetryAttempts":2,"startingPosition":"LATEST"}}}}}}},"SesBounceNotificationTopic":{"id":"SesBounceNotificationTopic","path":"YogaGoStack/SesBounceNotificationTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Topic","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/SesBounceNotificationTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{"displayName":"SES Bounce Notifications","topicName":"yoga-go-ses-bounce-notifications"}}},"Policy":{"id":"Policy","path":"YogaGoStack/SesBounceNotificationTopic/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.TopicPolicy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/SesBounceNotificationTopic/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopicPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::TopicPolicy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"sns:Publish","Condition":{"StringEquals":{"AWS:SourceAccount":"710735877057","AWS:SourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ses:ap-southeast-2:710735877057:configuration-set/",{"Ref":"SesConfigSetECAFDFF8"}]]}}},"Effect":"Allow","Principal":{"Service":"ses.amazonaws.com"},"Resource":{"Ref":"SesBounceNotificationTopic0C5D5AD9"},"Sid":"0"}],"Version":"2012-10-17"},"topics":[{"Ref":"SesBounceNotificationTopic0C5D5AD9"}]}}}}}}},"SesBounceHandlerLambda":{"id":"SesBounceHandlerLambda","path":"YogaGoStack/SesBounceHandlerLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.231.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"YogaGoStack/SesBounceHandlerLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.231.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"YogaGoStack/SesBounceHandlerLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"YogaGoStack/SesBounceHandlerLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"YogaGoStack/SesBounceHandlerLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/SesBounceHandlerLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},{"Fn::GetAtt":["EmailsTableF5BA4582","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},"/index/*"]]},{"Fn::Join":["",[{"Fn::GetAtt":["EmailsTableF5BA4582","Arn"]},"/index/*"]]}]}],"Version":"2012-10-17"},"policyName":"SesBounceHandlerLambdaServiceRoleDefaultPolicy937DA493","roles":[{"Ref":"SesBounceHandlerLambdaServiceRoleDB84AFED"}]}}}}}}},"Code":{"id":"Code","path":"YogaGoStack/SesBounceHandlerLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.231.0"},"children":{"Stage":{"id":"Stage","path":"YogaGoStack/SesBounceHandlerLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.231.0"}},"AssetBucket":{"id":"AssetBucket","path":"YogaGoStack/SesBounceHandlerLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.231.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"YogaGoStack/SesBounceHandlerLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-710735877057-ap-southeast-2","s3Key":"e725cbdcf4b34db3aafe87994a408247d34343cafa850bf214e58b5da38cd9f1.zip"},"environment":{"variables":{"DYNAMODB_TABLE":{"Ref":"CoreTable97EB8292"},"EMAILS_TABLE":"yoga-go-emails"}},"functionName":"yoga-go-ses-bounce-handler","handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["SesBounceHandlerLambdaServiceRoleDB84AFED","Arn"]},"runtime":"nodejs22.x","timeout":30}}},"AllowInvoke:YogaGoStackSesBounceNotificationTopic13D30990":{"id":"AllowInvoke:YogaGoStackSesBounceNotificationTopic13D30990","path":"YogaGoStack/SesBounceHandlerLambda/AllowInvoke:YogaGoStackSesBounceNotificationTopic13D30990","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["SesBounceHandlerLambdaECFA103D","Arn"]},"principal":"sns.amazonaws.com","sourceArn":{"Ref":"SesBounceNotificationTopic0C5D5AD9"}}}},"SesBounceNotificationTopic":{"id":"SesBounceNotificationTopic","path":"YogaGoStack/SesBounceHandlerLambda/SesBounceNotificationTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Subscription","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/SesBounceHandlerLambda/SesBounceNotificationTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnSubscription","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Subscription","aws:cdk:cloudformation:props":{"endpoint":{"Fn::GetAtt":["SesBounceHandlerLambdaECFA103D","Arn"]},"protocol":"lambda","topicArn":{"Ref":"SesBounceNotificationTopic0C5D5AD9"}}}}}}}},"OrdersTable":{"id":"OrdersTable","path":"YogaGoStack/OrdersTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/OrdersTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":false},"tableName":"yoga-go-orders"}}},"ScalingRole":{"id":"ScalingRole","path":"YogaGoStack/OrdersTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}}}},"AnalyticsTable":{"id":"AnalyticsTable","path":"YogaGoStack/AnalyticsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/AnalyticsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":false},"tableName":"yoga-go-analytics"}}},"ScalingRole":{"id":"ScalingRole","path":"YogaGoStack/AnalyticsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}}}},"DiscussionsTable":{"id":"DiscussionsTable","path":"YogaGoStack/DiscussionsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/DiscussionsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"GSI1PK","attributeType":"S"},{"attributeName":"GSI1SK","attributeType":"S"},{"attributeName":"GSI2PK","attributeType":"S"},{"attributeName":"GSI2SK","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"GSI1","keySchema":[{"attributeName":"GSI1PK","keyType":"HASH"},{"attributeName":"GSI1SK","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"GSI2","keySchema":[{"attributeName":"GSI2PK","keyType":"HASH"},{"attributeName":"GSI2SK","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":false},"streamSpecification":{"streamViewType":"NEW_IMAGE"},"tableName":"yoga-go-discussions","timeToLiveSpecification":{"attributeName":"ttl","enabled":true}}}},"ScalingRole":{"id":"ScalingRole","path":"YogaGoStack/DiscussionsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}}}},"BlogTable":{"id":"BlogTable","path":"YogaGoStack/BlogTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/BlogTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":false},"tableName":"yoga-go-blog"}}},"ScalingRole":{"id":"ScalingRole","path":"YogaGoStack/BlogTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}}}},"AssetsTable":{"id":"AssetsTable","path":"YogaGoStack/AssetsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/AssetsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"GSI1PK","attributeType":"S"},{"attributeName":"GSI1SK","attributeType":"S"},{"attributeName":"GSI2PK","attributeType":"S"},{"attributeName":"GSI2SK","attributeType":"S"},{"attributeName":"GSI3PK","attributeType":"S"},{"attributeName":"GSI3SK","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"GSI1","keySchema":[{"attributeName":"GSI1PK","keyType":"HASH"},{"attributeName":"GSI1SK","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"GSI2","keySchema":[{"attributeName":"GSI2PK","keyType":"HASH"},{"attributeName":"GSI2SK","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"GSI3","keySchema":[{"attributeName":"GSI3PK","keyType":"HASH"},{"attributeName":"GSI3SK","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":false},"tableName":"yoga-go-assets"}}},"ScalingRole":{"id":"ScalingRole","path":"YogaGoStack/AssetsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}}}},"BoostTable":{"id":"BoostTable","path":"YogaGoStack/BoostTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/BoostTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"GSI1PK","attributeType":"S"},{"attributeName":"GSI1SK","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"GSI1","keySchema":[{"attributeName":"GSI1PK","keyType":"HASH"},{"attributeName":"GSI1SK","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":false},"tableName":"yoga-go-boost"}}},"ScalingRole":{"id":"ScalingRole","path":"YogaGoStack/BoostTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}}}},"EmailsTable":{"id":"EmailsTable","path":"YogaGoStack/EmailsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/EmailsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"GSI1PK","attributeType":"S"},{"attributeName":"GSI1SK","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"GSI1","keySchema":[{"attributeName":"GSI1PK","keyType":"HASH"},{"attributeName":"GSI1SK","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":false},"streamSpecification":{"streamViewType":"NEW_IMAGE"},"tableName":"yoga-go-emails","timeToLiveSpecification":{"attributeName":"ttl","enabled":true}}}},"ScalingRole":{"id":"ScalingRole","path":"YogaGoStack/EmailsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}}}},"NotificationStreamLambda":{"id":"NotificationStreamLambda","path":"YogaGoStack/NotificationStreamLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.231.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"YogaGoStack/NotificationStreamLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.231.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"YogaGoStack/NotificationStreamLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"YogaGoStack/NotificationStreamLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"YogaGoStack/NotificationStreamLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/NotificationStreamLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DiscussionsTable250DB3EA","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DiscussionsTable250DB3EA","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:ConditionCheckItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["EmailsTableF5BA4582","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["EmailsTableF5BA4582","Arn"]},"/index/*"]]}]},{"Action":["secretsmanager:DescribeSecret","secretsmanager:GetSecretValue"],"Effect":"Allow","Resource":"arn:aws:secretsmanager:ap-southeast-2:710735877057:secret:yoga-go/production-??????"},{"Action":"dynamodb:ListStreams","Effect":"Allow","Resource":"*"},{"Action":["dynamodb:DescribeStream","dynamodb:GetRecords","dynamodb:GetShardIterator"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DiscussionsTable250DB3EA","StreamArn"]},{"Fn::GetAtt":["EmailsTableF5BA4582","StreamArn"]}]}],"Version":"2012-10-17"},"policyName":"NotificationStreamLambdaServiceRoleDefaultPolicy70229643","roles":[{"Ref":"NotificationStreamLambdaServiceRole41FD97D8"}]}}}}}}},"Code":{"id":"Code","path":"YogaGoStack/NotificationStreamLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.231.0"},"children":{"Stage":{"id":"Stage","path":"YogaGoStack/NotificationStreamLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.231.0"}},"AssetBucket":{"id":"AssetBucket","path":"YogaGoStack/NotificationStreamLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.231.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"YogaGoStack/NotificationStreamLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-710735877057-ap-southeast-2","s3Key":"73681810e46aac1125e238e60872eddde528dab9b7f7f6c41778508964d00077.zip"},"environment":{"variables":{"DYNAMODB_TABLE":{"Ref":"DiscussionsTable250DB3EA"},"EMAILS_TABLE":{"Ref":"EmailsTableF5BA4582"},"APP_DOMAIN":"myyoga.guru"}},"functionName":"yoga-go-notification-stream","handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["NotificationStreamLambdaServiceRole41FD97D8","Arn"]},"runtime":"nodejs22.x","timeout":30}}},"DynamoDBEventSource:YogaGoStackEmailsTableC516AC4C":{"id":"DynamoDBEventSource:YogaGoStackEmailsTableC516AC4C","path":"YogaGoStack/NotificationStreamLambda/DynamoDBEventSource:YogaGoStackEmailsTableC516AC4C","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/NotificationStreamLambda/DynamoDBEventSource:YogaGoStackEmailsTableC516AC4C/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":10,"eventSourceArn":{"Fn::GetAtt":["EmailsTableF5BA4582","StreamArn"]},"filterCriteria":{"filters":[{"pattern":"{\"eventName\":[\"INSERT\"],\"dynamodb\":{\"NewImage\":{\"isOutgoing\":{\"BOOL\":[false]}}}}"},{"pattern":"{\"eventName\":[\"INSERT\"],\"dynamodb\":{\"NewImage\":{\"isOutgoing\":[{\"exists\":false}]}}}"}]},"functionName":{"Ref":"NotificationStreamLambdaA4B4CCD5"},"maximumRetryAttempts":2,"startingPosition":"LATEST"}}}}},"DynamoDBEventSource:YogaGoStackDiscussionsTable81D6C5BD":{"id":"DynamoDBEventSource:YogaGoStackDiscussionsTable81D6C5BD","path":"YogaGoStack/NotificationStreamLambda/DynamoDBEventSource:YogaGoStackDiscussionsTable81D6C5BD","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/NotificationStreamLambda/DynamoDBEventSource:YogaGoStackDiscussionsTable81D6C5BD/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":10,"eventSourceArn":{"Fn::GetAtt":["DiscussionsTable250DB3EA","StreamArn"]},"filterCriteria":{"filters":[{"pattern":"{\"eventName\":[\"INSERT\"],\"dynamodb\":{\"NewImage\":{\"entityType\":{\"S\":[\"FORUM_THREAD\"]}}}}"},{"pattern":"{\"eventName\":[\"INSERT\"],\"dynamodb\":{\"NewImage\":{\"entityType\":{\"S\":[\"FORUM_REPLY\"]}}}}"}]},"functionName":{"Ref":"NotificationStreamLambdaA4B4CCD5"},"maximumRetryAttempts":2,"startingPosition":"LATEST"}}}}}}},"RecordingProcessorDLQ":{"id":"RecordingProcessorDLQ","path":"YogaGoStack/RecordingProcessorDLQ","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/RecordingProcessorDLQ/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":1209600,"queueName":"yoga-go-recording-processor-dlq"}}}}},"RecordingProcessorQueue":{"id":"RecordingProcessorQueue","path":"YogaGoStack/RecordingProcessorQueue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/RecordingProcessorQueue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"queueName":"yoga-go-recording-processor","receiveMessageWaitTimeSeconds":20,"redrivePolicy":{"deadLetterTargetArn":{"Fn::GetAtt":["RecordingProcessorDLQ70C748FC","Arn"]},"maxReceiveCount":3},"visibilityTimeout":900}}}}},"RecordingProcessorLambda":{"id":"RecordingProcessorLambda","path":"YogaGoStack/RecordingProcessorLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.231.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"YogaGoStack/RecordingProcessorLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.231.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"YogaGoStack/RecordingProcessorLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"YogaGoStack/RecordingProcessorLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"YogaGoStack/RecordingProcessorLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/RecordingProcessorLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},"/index/*"]]}]},{"Action":["secretsmanager:DescribeSecret","secretsmanager:GetSecretValue"],"Effect":"Allow","Resource":"arn:aws:secretsmanager:ap-southeast-2:710735877057:secret:yoga-go/production-??????"},{"Action":["sqs:ChangeMessageVisibility","sqs:DeleteMessage","sqs:GetQueueAttributes","sqs:GetQueueUrl","sqs:ReceiveMessage"],"Effect":"Allow","Resource":{"Fn::GetAtt":["RecordingProcessorQueueF58ADC25","Arn"]}}],"Version":"2012-10-17"},"policyName":"RecordingProcessorLambdaServiceRoleDefaultPolicy0D5699AC","roles":[{"Ref":"RecordingProcessorLambdaServiceRole6E77B2F6"}]}}}}}}},"Code":{"id":"Code","path":"YogaGoStack/RecordingProcessorLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.231.0"},"children":{"Stage":{"id":"Stage","path":"YogaGoStack/RecordingProcessorLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.231.0"}},"AssetBucket":{"id":"AssetBucket","path":"YogaGoStack/RecordingProcessorLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.231.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"YogaGoStack/RecordingProcessorLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-710735877057-ap-southeast-2","s3Key":"e79b4901acdb96b1f3ebf80064ecc08cf51197db79feaf17143c924ac05cb8bc.zip"},"environment":{"variables":{"DYNAMODB_TABLE":{"Ref":"CoreTable97EB8292"},"AWS_DYNAMODB_REGION":"ap-southeast-2"}},"functionName":"yoga-go-recording-processor","handler":"index.handler","memorySize":1024,"role":{"Fn::GetAtt":["RecordingProcessorLambdaServiceRole6E77B2F6","Arn"]},"runtime":"nodejs22.x","timeout":900}}},"SqsEventSource:YogaGoStackRecordingProcessorQueueFECB4F1F":{"id":"SqsEventSource:YogaGoStackRecordingProcessorQueueFECB4F1F","path":"YogaGoStack/RecordingProcessorLambda/SqsEventSource:YogaGoStackRecordingProcessorQueueFECB4F1F","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/RecordingProcessorLambda/SqsEventSource:YogaGoStackRecordingProcessorQueueFECB4F1F/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":1,"eventSourceArn":{"Fn::GetAtt":["RecordingProcessorQueueF58ADC25","Arn"]},"functionName":{"Ref":"RecordingProcessorLambda52D97285"},"scalingConfig":{"maximumConcurrency":5}}}}}}}},"RecordingQueueUrl":{"id":"RecordingQueueUrl","path":"YogaGoStack/RecordingQueueUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"VercelUser":{"id":"VercelUser","path":"YogaGoStack/VercelUser","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.User","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoStack/VercelUser/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnUser","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::User","aws:cdk:cloudformation:props":{"managedPolicyArns":[{"Ref":"VercelPolicy7DDA1F5D"}],"userName":"yoga-go-vercel"}}}}},"VercelPolicy":{"id":"VercelPolicy","path":"YogaGoStack/VercelPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.ManagedPolicy","version":"2.231.0","metadata":[]},"children":{"ImportedVercelPolicy":{"id":"ImportedVercelPolicy","path":"YogaGoStack/VercelPolicy/ImportedVercelPolicy","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"YogaGoStack/VercelPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnManagedPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::ManagedPolicy","aws:cdk:cloudformation:props":{"description":"","managedPolicyName":"yoga-go-vercel-policy","path":"/","policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:DeleteItem","dynamodb:GetItem","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":["arn:aws:dynamodb:ap-southeast-2:710735877057:table/yoga-go-analytics","arn:aws:dynamodb:ap-southeast-2:710735877057:table/yoga-go-analytics/index/*","arn:aws:dynamodb:ap-southeast-2:710735877057:table/yoga-go-orders","arn:aws:dynamodb:ap-southeast-2:710735877057:table/yoga-go-orders/index/*",{"Fn::GetAtt":["AssetsTableB17E4AB4","Arn"]},{"Fn::GetAtt":["BlogTable4F8B6C55","Arn"]},{"Fn::GetAtt":["BoostTable75343769","Arn"]},{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},{"Fn::GetAtt":["DiscussionsTable250DB3EA","Arn"]},{"Fn::GetAtt":["EmailsTableF5BA4582","Arn"]},{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AssetsTableB17E4AB4","Arn"]},"/index/*"]]},{"Fn::Join":["",[{"Fn::GetAtt":["BlogTable4F8B6C55","Arn"]},"/index/*"]]},{"Fn::Join":["",[{"Fn::GetAtt":["BoostTable75343769","Arn"]},"/index/*"]]},{"Fn::Join":["",[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},"/index/*"]]},{"Fn::Join":["",[{"Fn::GetAtt":["DiscussionsTable250DB3EA","Arn"]},"/index/*"]]},{"Fn::Join":["",[{"Fn::GetAtt":["EmailsTableF5BA4582","Arn"]},"/index/*"]]},{"Fn::Join":["",[{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},"/index/*"]]}]},{"Action":["ses:SendEmail","ses:SendRawEmail","ses:SendTemplatedEmail"],"Condition":{"StringLike":{"ses:FromAddress":"*@myyoga.guru"}},"Effect":"Allow","Resource":"*"},{"Action":["ses:CreateEmailIdentity","ses:DeleteEmailIdentity","ses:GetEmailIdentity"],"Effect":"Allow","Resource":"*"},{"Action":["cognito-idp:AdminGetUser","cognito-idp:DescribeUserPool","cognito-idp:DescribeUserPoolClient","cognito-idp:GetUser"],"Effect":"Allow","Resource":{"Fn::GetAtt":["YogaGoUserPool95F58773","Arn"]}},{"Action":"sqs:SendMessage","Effect":"Allow","Resource":{"Fn::GetAtt":["RecordingProcessorQueueF58ADC25","Arn"]}}],"Version":"2012-10-17"}}}}}},"VercelUserArn":{"id":"VercelUserArn","path":"YogaGoStack/VercelUserArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"UserPoolId":{"id":"UserPoolId","path":"YogaGoStack/UserPoolId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"UserPoolClientId":{"id":"UserPoolClientId","path":"YogaGoStack/UserPoolClientId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"CognitoDomain":{"id":"CognitoDomain","path":"YogaGoStack/CognitoDomain","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"DynamoDBCoreTableName":{"id":"DynamoDBCoreTableName","path":"YogaGoStack/DynamoDBCoreTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"SESConfigSetName":{"id":"SESConfigSetName","path":"YogaGoStack/SESConfigSetName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"YogaGoStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Default":{"id":"Default","path":"YogaGoStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.231.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"YogaGoStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.231.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"YogaGoStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.231.0"}}}},"YogaGoSesStack":{"id":"YogaGoSesStack","path":"YogaGoSesStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.231.0"},"children":{"EmailIdentity":{"id":"EmailIdentity","path":"YogaGoSesStack/EmailIdentity","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.EmailIdentity","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/EmailIdentity/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnEmailIdentity","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::EmailIdentity","aws:cdk:cloudformation:props":{"emailIdentity":"myyoga.guru"}}}}},"CallyEmailIdentity":{"id":"CallyEmailIdentity","path":"YogaGoSesStack/CallyEmailIdentity","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.EmailIdentity","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/CallyEmailIdentity/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnEmailIdentity","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::EmailIdentity","aws:cdk:cloudformation:props":{"emailIdentity":"callygo.com"}}}}},"SesConfigSet":{"id":"SesConfigSet","path":"YogaGoSesStack/SesConfigSet","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.ConfigurationSet","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/SesConfigSet/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnConfigurationSet","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::ConfigurationSet","aws:cdk:cloudformation:props":{"name":"yoga-go-emails-west","reputationOptions":{"reputationMetricsEnabled":true},"sendingOptions":{"sendingEnabled":true}}}},"CloudWatchDestination":{"id":"CloudWatchDestination","path":"YogaGoSesStack/SesConfigSet/CloudWatchDestination","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.ConfigurationSetEventDestination","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/SesConfigSet/CloudWatchDestination/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnConfigurationSetEventDestination","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::ConfigurationSetEventDestination","aws:cdk:cloudformation:props":{"configurationSetName":{"Ref":"SesConfigSetECAFDFF8"},"eventDestination":{"enabled":true,"matchingEventTypes":["send","delivery","bounce","complaint","reject","open","click"],"cloudWatchDestination":{"dimensionConfigurations":[{"dimensionValueSource":"messageTag","dimensionName":"EmailType","defaultDimensionValue":"transactional"}]}}}}}}}}},"WelcomeEmailTemplate":{"id":"WelcomeEmailTemplate","path":"YogaGoSesStack/WelcomeEmailTemplate","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnTemplate","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::Template","aws:cdk:cloudformation:props":{"template":{"templateName":"yoga-go-welcome","subjectPart":"Welcome to MyYoga.Guru! ðŸ§˜","textPart":"Hi {{name}},\n\nWelcome to MyYoga.Guru!\n\nWe're thrilled to have you join our community of yoga enthusiasts.\n\nNamaste,\nThe MyYoga.Guru Team","htmlPart":"<!DOCTYPE html>\n<html><body style=\"font-family: sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n<h1 style=\"color: #6366f1;\">ðŸ§˜ MyYoga.Guru</h1>\n<h2>Hi {{name}}!</h2>\n<p>Welcome to <strong>MyYoga.Guru</strong>!</p>\n<p>We're thrilled to have you join our community of yoga enthusiasts.</p>\n<div style=\"text-align: center; margin: 30px 0;\">\n<a href=\"https://www.myyoga.guru/app\" style=\"background-color: #6366f1; color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px;\">Start Exploring</a>\n</div>\n<p><strong>Namaste,</strong><br>The MyYoga.Guru Team</p>\n</body></html>"}}}},"InvoiceEmailTemplate":{"id":"InvoiceEmailTemplate","path":"YogaGoSesStack/InvoiceEmailTemplate","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnTemplate","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::Template","aws:cdk:cloudformation:props":{"template":{"templateName":"yoga-go-invoice","subjectPart":"Payment Confirmation - Order #{{orderId}} ðŸ§˜","textPart":"Hi {{customerName}},\n\nThank you for your purchase!\n\nOrder ID: {{orderId}}\nAmount: {{currency}} {{amount}}\nStatus: PAID\n\nNamaste,\nThe MyYoga.Guru Team","htmlPart":"<!DOCTYPE html>\n<html><body style=\"font-family: sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n<h1 style=\"color: #6366f1;\">ðŸ§˜ MyYoga.Guru - Payment Confirmation</h1>\n<p>Hi <strong>{{customerName}}</strong>,</p>\n<p>Thank you for your purchase!</p>\n<div style=\"background: #f3f4f6; padding: 20px; border-radius: 8px; margin: 20px 0;\">\n<p><strong>Order ID:</strong> {{orderId}}</p>\n<p><strong>Amount:</strong> {{currency}} {{amount}}</p>\n<p><strong>Status:</strong> <span style=\"color: #16a34a;\">PAID</span></p>\n</div>\n<p><strong>Namaste,</strong><br>The MyYoga.Guru Team</p>\n</body></html>"}}}},"EmailBucket":{"id":"EmailBucket","path":"YogaGoSesStack/EmailBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/EmailBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"yoga-go-incoming-emails-710735877057","corsConfiguration":{"corsRules":[{"allowedHeaders":["*"],"allowedMethods":["PUT"],"allowedOrigins":["http://localhost:3113","https://proj-cally.vercel.app","https://callygo.com","https://www.callygo.com"]}]},"lifecycleConfiguration":{"rules":[{"expirationInDays":1,"id":"DeleteIncomingAfterOneDay","prefix":"incoming/","status":"Enabled"},{"expirationInDays":90,"id":"DeleteParsedAfter90Days","prefix":"parsed/","status":"Enabled"},{"expirationInDays":30,"id":"DeleteReplyAttachmentsAfter30Days","prefix":"reply-attachments/","status":"Enabled"}]},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}}},"Policy":{"id":"Policy","path":"YogaGoSesStack/EmailBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/EmailBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"EmailBucket843A740F"},"policyDocument":{"Statement":[{"Action":["s3:DeleteObject*","s3:GetBucket*","s3:List*","s3:PutBucketPolicy"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["EmailBucket843A740F","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["EmailBucket843A740F","Arn"]},"/*"]]}]},{"Action":"s3:PutObject","Condition":{"StringEquals":{"AWS:SourceAccount":"710735877057"}},"Effect":"Allow","Principal":{"Service":"ses.amazonaws.com"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["EmailBucket843A740F","Arn"]},"/*"]]}},{"Action":"s3:PutObject","Condition":{"StringEquals":{"aws:SourceAccount":{"Ref":"AWS::AccountId"}}},"Effect":"Allow","Principal":{"Service":"ses.amazonaws.com"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["EmailBucket843A740F","Arn"]},"/incoming/*"]]}}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"YogaGoSesStack/EmailBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.231.0","metadata":[]},"children":{"Default":{"id":"Default","path":"YogaGoSesStack/EmailBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.231.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"YogaGoSesStack/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.231.0"},"children":{"Staging":{"id":"Staging","path":"YogaGoSesStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.231.0"}},"Role":{"id":"Role","path":"YogaGoSesStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.231.0"}},"Handler":{"id":"Handler","path":"YogaGoSesStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.231.0"}}}},"EmailForwarderLambda":{"id":"EmailForwarderLambda","path":"YogaGoSesStack/EmailForwarderLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.231.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"YogaGoSesStack/EmailForwarderLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.231.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"YogaGoSesStack/EmailForwarderLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"YogaGoSesStack/EmailForwarderLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"YogaGoSesStack/EmailForwarderLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/EmailForwarderLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:Abort*","s3:DeleteObject*","s3:GetBucket*","s3:GetObject*","s3:List*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["EmailBucket843A740F","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["EmailBucket843A740F","Arn"]},"/*"]]}]},{"Action":["dynamodb:GetItem","dynamodb:Query"],"Effect":"Allow","Resource":["arn:aws:dynamodb:ap-southeast-2:710735877057:table/yoga-go-core","arn:aws:dynamodb:ap-southeast-2:710735877057:table/yoga-go-core/index/*"]},{"Action":["dynamodb:PutItem","dynamodb:Query","dynamodb:UpdateItem"],"Effect":"Allow","Resource":"arn:aws:dynamodb:ap-southeast-2:710735877057:table/yoga-go-emails"},{"Action":"ses:SendRawEmail","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"EmailForwarderLambdaServiceRoleDefaultPolicy8355EF21","roles":[{"Ref":"EmailForwarderLambdaServiceRoleADFA6A56"}]}}}}}}},"Code":{"id":"Code","path":"YogaGoSesStack/EmailForwarderLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.231.0"},"children":{"Stage":{"id":"Stage","path":"YogaGoSesStack/EmailForwarderLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.231.0"}},"AssetBucket":{"id":"AssetBucket","path":"YogaGoSesStack/EmailForwarderLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.231.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"YogaGoSesStack/EmailForwarderLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-710735877057-us-west-2","s3Key":"bf18d6d0b4c956b3deb0040926601998559df09db7fcb12614ec935d4dd3b9c5.zip"},"environment":{"variables":{"DYNAMODB_TABLE":"yoga-go-core","EMAILS_TABLE":"yoga-go-emails","EMAIL_BUCKET":{"Ref":"EmailBucket843A740F"},"DEFAULT_FROM_EMAIL":"hi@myyoga.guru","APP_DOMAIN":"myyoga.guru","PLATFORM_ADMIN_EMAILS":"hi@arun.au"}},"functionName":"yoga-go-email-forwarder","handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["EmailForwarderLambdaServiceRoleADFA6A56","Arn"]},"runtime":"nodejs22.x","timeout":30}}},"AllowSES":{"id":"AllowSES","path":"YogaGoSesStack/EmailForwarderLambda/AllowSES","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["EmailForwarderLambda9E13D248","Arn"]},"principal":"ses.amazonaws.com","sourceAccount":"710735877057"}}},"AllowSes":{"id":"AllowSes","path":"YogaGoSesStack/EmailForwarderLambda/AllowSes","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["EmailForwarderLambda9E13D248","Arn"]},"principal":"ses.amazonaws.com","sourceAccount":{"Ref":"AWS::AccountId"}}}}}},"EmailReceiptRuleSet":{"id":"EmailReceiptRuleSet","path":"YogaGoSesStack/EmailReceiptRuleSet","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.ReceiptRuleSet","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/EmailReceiptRuleSet/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnReceiptRuleSet","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::ReceiptRuleSet","aws:cdk:cloudformation:props":{"ruleSetName":"yoga-go-inbound"}}},"ForwardPlatformEmails":{"id":"ForwardPlatformEmails","path":"YogaGoSesStack/EmailReceiptRuleSet/ForwardPlatformEmails","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.ReceiptRule","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/EmailReceiptRuleSet/ForwardPlatformEmails/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnReceiptRule","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::ReceiptRule","aws:cdk:cloudformation:props":{"rule":{"actions":[{"s3Action":{"bucketName":{"Ref":"EmailBucket843A740F"},"objectKeyPrefix":"incoming/"}},{"lambdaAction":{"functionArn":{"Fn::GetAtt":["EmailForwarderLambda9E13D248","Arn"]},"invocationType":"Event"}},{"stopAction":{"scope":"RuleSet"}}],"enabled":true,"recipients":["myyoga.guru"],"scanEnabled":true},"ruleSetName":{"Ref":"EmailReceiptRuleSet45DC1ECE"}}}}}},"ForwardCallyEmails":{"id":"ForwardCallyEmails","path":"YogaGoSesStack/EmailReceiptRuleSet/ForwardCallyEmails","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.ReceiptRule","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/EmailReceiptRuleSet/ForwardCallyEmails/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnReceiptRule","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::ReceiptRule","aws:cdk:cloudformation:props":{"after":{"Ref":"EmailReceiptRuleSetForwardPlatformEmails050EBEAE"},"rule":{"actions":[{"s3Action":{"bucketName":{"Ref":"EmailBucket843A740F"},"objectKeyPrefix":"incoming/"}},{"lambdaAction":{"functionArn":{"Fn::GetAtt":["EmailForwarderLambda9E13D248","Arn"]},"invocationType":"Event"}},{"stopAction":{"scope":"RuleSet"}}],"enabled":true,"recipients":["callygo.com"],"scanEnabled":true},"ruleSetName":{"Ref":"EmailReceiptRuleSet45DC1ECE"}}}}}},"ForwardByodEmails":{"id":"ForwardByodEmails","path":"YogaGoSesStack/EmailReceiptRuleSet/ForwardByodEmails","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.ReceiptRule","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/EmailReceiptRuleSet/ForwardByodEmails/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnReceiptRule","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::ReceiptRule","aws:cdk:cloudformation:props":{"after":{"Ref":"EmailReceiptRuleSetForwardCallyEmails775D7607"},"rule":{"actions":[{"s3Action":{"bucketName":{"Ref":"EmailBucket843A740F"},"objectKeyPrefix":"incoming/"}},{"lambdaAction":{"functionArn":{"Fn::GetAtt":["EmailForwarderLambda9E13D248","Arn"]},"invocationType":"Event"}}],"enabled":true,"recipients":[],"scanEnabled":true},"ruleSetName":{"Ref":"EmailReceiptRuleSet45DC1ECE"}}}}}}}},"SmtpUser":{"id":"SmtpUser","path":"YogaGoSesStack/SmtpUser","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.User","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/SmtpUser/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnUser","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::User","aws:cdk:cloudformation:props":{"userName":"yoga-go-smtp-user"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"YogaGoSesStack/SmtpUser/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/SmtpUser/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["ses:SendEmail","ses:SendRawEmail"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"SmtpUserDefaultPolicy2A3E51B8","users":[{"Ref":"SmtpUser17EE1BF6"}]}}}}}}},"SmtpAccessKey":{"id":"SmtpAccessKey","path":"YogaGoSesStack/SmtpAccessKey","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.AccessKey","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/SmtpAccessKey/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnAccessKey","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::AccessKey","aws:cdk:cloudformation:props":{"userName":{"Ref":"SmtpUser17EE1BF6"}}}}}},"SmtpCredentialsSecret":{"id":"SmtpCredentialsSecret","path":"YogaGoSesStack/SmtpCredentialsSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"YogaGoSesStack/SmtpCredentialsSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"SES SMTP credentials for Gmail integration","name":"yoga-go/smtp-credentials","secretString":{"Fn::Join":["",["{\"accessKeyId\":\"",{"Ref":"SmtpAccessKey5962B0B0"},"\",\"secretAccessKey\":\"",{"Fn::GetAtt":["SmtpAccessKey5962B0B0","SecretAccessKey"]},"\",\"smtpServer\":\"email-smtp.us-west-2.amazonaws.com\",\"smtpPort\":\"587\"}"]]}}}}}},"SESConfigSetName":{"id":"SESConfigSetName","path":"YogaGoSesStack/SESConfigSetName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"EmailBucketName":{"id":"EmailBucketName","path":"YogaGoSesStack/EmailBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"EmailForwarderLambdaArn":{"id":"EmailForwarderLambdaArn","path":"YogaGoSesStack/EmailForwarderLambdaArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"ReceiptRuleSetName":{"id":"ReceiptRuleSetName","path":"YogaGoSesStack/ReceiptRuleSetName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"SmtpCredentialsSecretArn":{"id":"SmtpCredentialsSecretArn","path":"YogaGoSesStack/SmtpCredentialsSecretArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"SmtpServer":{"id":"SmtpServer","path":"YogaGoSesStack/SmtpServer","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"SmtpPort":{"id":"SmtpPort","path":"YogaGoSesStack/SmtpPort","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"YogaGoSesStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Default":{"id":"Default","path":"YogaGoSesStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.231.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"YogaGoSesStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.231.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"YogaGoSesStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.231.0"}}}},"CalelStack":{"id":"CalelStack","path":"CalelStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.231.0"},"children":{"CoreTable":{"id":"CoreTable","path":"CalelStack/CoreTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CalelStack/CoreTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"GSI1PK","attributeType":"S"},{"attributeName":"GSI1SK","attributeType":"S"},{"attributeName":"GSI2PK","attributeType":"S"},{"attributeName":"GSI2SK","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"GSI1","keySchema":[{"attributeName":"GSI1PK","keyType":"HASH"},{"attributeName":"GSI1SK","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"GSI2","keySchema":[{"attributeName":"GSI2PK","keyType":"HASH"},{"attributeName":"GSI2SK","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":false},"tableName":"calel-core"}}},"ScalingRole":{"id":"ScalingRole","path":"CalelStack/CoreTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}}}},"NotificationDLQ":{"id":"NotificationDLQ","path":"CalelStack/NotificationDLQ","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CalelStack/NotificationDLQ/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":1209600,"queueName":"calel-notification-dlq"}}}}},"NotificationQueue":{"id":"NotificationQueue","path":"CalelStack/NotificationQueue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CalelStack/NotificationQueue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":345600,"queueName":"calel-notifications","redrivePolicy":{"deadLetterTargetArn":{"Fn::GetAtt":["NotificationDLQCDA15FAF","Arn"]},"maxReceiveCount":3},"visibilityTimeout":60}}}}},"WebhookDLQ":{"id":"WebhookDLQ","path":"CalelStack/WebhookDLQ","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CalelStack/WebhookDLQ/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":1209600,"queueName":"calel-webhook-dlq"}}}}},"WebhookQueue":{"id":"WebhookQueue","path":"CalelStack/WebhookQueue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CalelStack/WebhookQueue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":345600,"queueName":"calel-webhooks","redrivePolicy":{"deadLetterTargetArn":{"Fn::GetAtt":["WebhookDLQ42AE1751","Arn"]},"maxReceiveCount":5},"visibilityTimeout":30}}}}},"PostConfirmationLambda":{"id":"PostConfirmationLambda","path":"CalelStack/PostConfirmationLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.231.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"CalelStack/PostConfirmationLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.231.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"CalelStack/PostConfirmationLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"CalelStack/PostConfirmationLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"CalelStack/PostConfirmationLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CalelStack/PostConfirmationLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},"/index/*"]]}]}],"Version":"2012-10-17"},"policyName":"PostConfirmationLambdaServiceRoleDefaultPolicy5EC3124B","roles":[{"Ref":"PostConfirmationLambdaServiceRole80A1DAC4"}]}}}}}}},"Code":{"id":"Code","path":"CalelStack/PostConfirmationLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.231.0"},"children":{"Stage":{"id":"Stage","path":"CalelStack/PostConfirmationLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.231.0"}},"AssetBucket":{"id":"AssetBucket","path":"CalelStack/PostConfirmationLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.231.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"CalelStack/PostConfirmationLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-710735877057-ap-southeast-2","s3Key":"fd6db6fffa52ebc9ebc54193e90e49be2eeedea5c7df7e3bce496705429a1234.zip"},"environment":{"variables":{"TABLE_NAME":{"Ref":"CoreTable97EB8292"}}},"handler":"index.handler","role":{"Fn::GetAtt":["PostConfirmationLambdaServiceRole80A1DAC4","Arn"]},"runtime":"nodejs20.x","timeout":10}}}}},"CalelUserPool":{"id":"CalelUserPool","path":"CalelStack/CalelUserPool","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPool","version":"2.231.0","metadata":[]},"children":{"PostConfirmationCognito":{"id":"PostConfirmationCognito","path":"CalelStack/CalelUserPool/PostConfirmationCognito","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["PostConfirmationLambdaC4F60401","Arn"]},"principal":"cognito-idp.amazonaws.com","sourceArn":{"Fn::GetAtt":["CalelUserPool185FF41F","Arn"]}}}},"Resource":{"id":"Resource","path":"CalelStack/CalelUserPool/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPool","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPool","aws:cdk:cloudformation:props":{"accountRecoverySetting":{"recoveryMechanisms":[{"name":"verified_email","priority":1}]},"adminCreateUserConfig":{"allowAdminCreateUserOnly":false},"autoVerifiedAttributes":["email"],"emailVerificationMessage":"The verification code to your new account is {####}","emailVerificationSubject":"Verify your new account","lambdaConfig":{"postConfirmation":{"Fn::GetAtt":["PostConfirmationLambdaC4F60401","Arn"]}},"policies":{"passwordPolicy":{"minimumLength":8,"requireLowercase":true,"requireUppercase":true,"requireNumbers":true,"requireSymbols":false}},"schema":[{"name":"email","mutable":true,"required":true},{"name":"given_name","mutable":true,"required":false},{"name":"family_name","mutable":true,"required":false},{"name":"tenantId","attributeDataType":"String","mutable":false},{"name":"tenantName","attributeDataType":"String","mutable":true}],"smsVerificationMessage":"The verification code to your new account is {####}","usernameAttributes":["email"],"userPoolName":"calel-users","verificationMessageTemplate":{"defaultEmailOption":"CONFIRM_WITH_CODE","emailMessage":"The verification code to your new account is {####}","emailSubject":"Verify your new account","smsMessage":"The verification code to your new account is {####}"}}}}}},"CalelWebClient":{"id":"CalelWebClient","path":"CalelStack/CalelWebClient","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolClient","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CalelStack/CalelWebClient/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolClient","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolClient","aws:cdk:cloudformation:props":{"accessTokenValidity":60,"allowedOAuthFlows":["implicit","code"],"allowedOAuthFlowsUserPoolClient":true,"allowedOAuthScopes":["profile","phone","email","openid","aws.cognito.signin.user.admin"],"callbackUrLs":["https://example.com"],"clientName":"calel-web","explicitAuthFlows":["ALLOW_USER_PASSWORD_AUTH","ALLOW_USER_SRP_AUTH","ALLOW_REFRESH_TOKEN_AUTH"],"generateSecret":false,"idTokenValidity":60,"preventUserExistenceErrors":"ENABLED","refreshTokenValidity":43200,"supportedIdentityProviders":["COGNITO"],"tokenValidityUnits":{"idToken":"minutes","accessToken":"minutes","refreshToken":"minutes"},"userPoolId":{"Ref":"CalelUserPool185FF41F"}}}}}},"PostConfirmationCognitoPolicy":{"id":"PostConfirmationCognitoPolicy","path":"CalelStack/PostConfirmationCognitoPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CalelStack/PostConfirmationCognitoPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"cognito-idp:AdminUpdateUserAttributes","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"PostConfirmationCognitoPolicy7C4AC4E8","roles":[{"Ref":"PostConfirmationLambdaServiceRole80A1DAC4"}]}}}}},"VercelUser":{"id":"VercelUser","path":"CalelStack/VercelUser","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.User","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CalelStack/VercelUser/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnUser","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::User","aws:cdk:cloudformation:props":{"managedPolicyArns":[{"Ref":"VercelPolicy7DDA1F5D"}],"userName":"calel-vercel"}}}}},"VercelPolicy":{"id":"VercelPolicy","path":"CalelStack/VercelPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.ManagedPolicy","version":"2.231.0","metadata":[]},"children":{"ImportedVercelPolicy":{"id":"ImportedVercelPolicy","path":"CalelStack/VercelPolicy/ImportedVercelPolicy","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"CalelStack/VercelPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnManagedPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::ManagedPolicy","aws:cdk:cloudformation:props":{"description":"","managedPolicyName":"calel-vercel-policy","path":"/","policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:DeleteItem","dynamodb:GetItem","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},"/index/*"]]}]},{"Action":["sqs:GetQueueAttributes","sqs:SendMessage"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["NotificationQueue36610CC1","Arn"]},{"Fn::GetAtt":["WebhookQueueA9D318EA","Arn"]}]}],"Version":"2012-10-17"}}}}}},"CoreTableName":{"id":"CoreTableName","path":"CalelStack/CoreTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"CoreTableArn":{"id":"CoreTableArn","path":"CalelStack/CoreTableArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"NotificationQueueUrl":{"id":"NotificationQueueUrl","path":"CalelStack/NotificationQueueUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"WebhookQueueUrl":{"id":"WebhookQueueUrl","path":"CalelStack/WebhookQueueUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"VercelUserArn":{"id":"VercelUserArn","path":"CalelStack/VercelUserArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"UserPoolId":{"id":"UserPoolId","path":"CalelStack/UserPoolId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"UserPoolClientId":{"id":"UserPoolClientId","path":"CalelStack/UserPoolClientId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"CognitoRegion":{"id":"CognitoRegion","path":"CalelStack/CognitoRegion","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"CalelStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Default":{"id":"Default","path":"CalelStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.231.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"CalelStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.231.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"CalelStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.231.0"}}}},"CallyStack":{"id":"CallyStack","path":"CallyStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.231.0"},"children":{"AppSecretEnsureExists":{"id":"AppSecretEnsureExists","path":"CallyStack/AppSecretEnsureExists","constructInfo":{"fqn":"aws-cdk-lib.custom_resources.AwsCustomResource","version":"2.231.0"},"children":{"Provider":{"id":"Provider","path":"CallyStack/AppSecretEnsureExists/Provider","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.SingletonFunction","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"CallyStack/AppSecretEnsureExists/Resource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.231.0","metadata":[]},"children":{"Default":{"id":"Default","path":"CallyStack/AppSecretEnsureExists/Resource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.231.0"}}}},"CustomResourcePolicy":{"id":"CustomResourcePolicy","path":"CallyStack/AppSecretEnsureExists/CustomResourcePolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/AppSecretEnsureExists/CustomResourcePolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"secretsmanager:CreateSecret","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"AppSecretEnsureExistsCustomResourcePolicyFED3A97B","roles":[{"Ref":"AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2"}]}}}}}}},"AWS679f53fac002430cb0da5b7982bd2287":{"id":"AWS679f53fac002430cb0da5b7982bd2287","path":"CallyStack/AWS679f53fac002430cb0da5b7982bd2287","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.231.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"CallyStack/AWS679f53fac002430cb0da5b7982bd2287/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.231.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"CallyStack/AWS679f53fac002430cb0da5b7982bd2287/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"CallyStack/AWS679f53fac002430cb0da5b7982bd2287/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Code":{"id":"Code","path":"CallyStack/AWS679f53fac002430cb0da5b7982bd2287/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.231.0"},"children":{"Stage":{"id":"Stage","path":"CallyStack/AWS679f53fac002430cb0da5b7982bd2287/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.231.0"}},"AssetBucket":{"id":"AssetBucket","path":"CallyStack/AWS679f53fac002430cb0da5b7982bd2287/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.231.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"CallyStack/AWS679f53fac002430cb0da5b7982bd2287/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-710735877057-ap-southeast-2","s3Key":"bc8ef58951f4c88e641dd23090e9d2e2e61c7530a07960e767522941e959b625.zip"},"handler":"index.handler","role":{"Fn::GetAtt":["AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2","Arn"]},"runtime":"nodejs22.x","timeout":120}}}}},"AppSecret":{"id":"AppSecret","path":"CallyStack/AppSecret","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"CoreTable":{"id":"CoreTable","path":"CallyStack/CoreTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/CoreTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"GSI1PK","attributeType":"S"},{"attributeName":"GSI1SK","attributeType":"S"},{"attributeName":"GSI2PK","attributeType":"S"},{"attributeName":"GSI2SK","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"GSI1","keySchema":[{"attributeName":"GSI1PK","keyType":"HASH"},{"attributeName":"GSI1SK","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"GSI2","keySchema":[{"attributeName":"GSI2PK","keyType":"HASH"},{"attributeName":"GSI2SK","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":false},"tableName":"cally-main","timeToLiveSpecification":{"attributeName":"ttl","enabled":true}}}},"ScalingRole":{"id":"ScalingRole","path":"CallyStack/CoreTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}}}},"AudioBucket":{"id":"AudioBucket","path":"CallyStack/AudioBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/AudioBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketName":"cally-audio-files-710735877057","corsConfiguration":{"corsRules":[{"allowedHeaders":["*"],"allowedMethods":["GET","PUT"],"allowedOrigins":["*"]}]},"lifecycleConfiguration":{"rules":[{"expirationInDays":7,"id":"DeleteOldBriefings","prefix":"briefings/","status":"Enabled"},{"expirationInDays":30,"id":"DeleteOldTranscripts","prefix":"transcripts/","status":"Enabled"}]},"publicAccessBlockConfiguration":{"blockPublicAcls":false,"blockPublicPolicy":false,"ignorePublicAcls":false,"restrictPublicBuckets":false}}}},"Policy":{"id":"Policy","path":"CallyStack/AudioBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/AudioBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"AudioBucket96BEECBA"},"policyDocument":{"Statement":[{"Action":"s3:GetObject","Effect":"Allow","Principal":{"AWS":"*"},"Resource":[{"Fn::Join":["",[{"Fn::GetAtt":["AudioBucket96BEECBA","Arn"]},"/briefings/*"]]},{"Fn::Join":["",[{"Fn::GetAtt":["AudioBucket96BEECBA","Arn"]},"/landing-pages/*"]]}]}],"Version":"2012-10-17"}}}}}}}},"TranscriptionDLQ":{"id":"TranscriptionDLQ","path":"CallyStack/TranscriptionDLQ","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/TranscriptionDLQ/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":1209600,"queueName":"cally-transcription-dlq"}}}}},"TranscriptionQueue":{"id":"TranscriptionQueue","path":"CallyStack/TranscriptionQueue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/TranscriptionQueue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":604800,"queueName":"cally-transcription-queue","redrivePolicy":{"deadLetterTargetArn":{"Fn::GetAtt":["TranscriptionDLQ14BD709D","Arn"]},"maxReceiveCount":3},"visibilityTimeout":900}}}}},"TranscriptionProcessor":{"id":"TranscriptionProcessor","path":"CallyStack/TranscriptionProcessor","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.231.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"CallyStack/TranscriptionProcessor/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.231.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"CallyStack/TranscriptionProcessor/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"CallyStack/TranscriptionProcessor/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"CallyStack/TranscriptionProcessor/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/TranscriptionProcessor/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},"/index/*"]]}]},{"Action":["s3:GetBucket*","s3:GetObject*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["AudioBucket96BEECBA","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AudioBucket96BEECBA","Arn"]},"/*"]]}]},{"Action":["secretsmanager:DescribeSecret","secretsmanager:GetSecretValue"],"Effect":"Allow","Resource":"arn:aws:secretsmanager:ap-southeast-2:710735877057:secret:cally/production-??????"},{"Action":["sqs:ChangeMessageVisibility","sqs:DeleteMessage","sqs:GetQueueAttributes","sqs:GetQueueUrl","sqs:ReceiveMessage"],"Effect":"Allow","Resource":{"Fn::GetAtt":["TranscriptionQueue01B856E8","Arn"]}}],"Version":"2012-10-17"},"policyName":"TranscriptionProcessorServiceRoleDefaultPolicy94DE3BCF","roles":[{"Ref":"TranscriptionProcessorServiceRoleF833FEA0"}]}}}}}}},"Code":{"id":"Code","path":"CallyStack/TranscriptionProcessor/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.231.0"},"children":{"Stage":{"id":"Stage","path":"CallyStack/TranscriptionProcessor/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.231.0"}},"AssetBucket":{"id":"AssetBucket","path":"CallyStack/TranscriptionProcessor/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.231.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"CallyStack/TranscriptionProcessor/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-710735877057-ap-southeast-2","s3Key":"4805947949ca12846ab146fb303a0bf5e63c927acc992d32fface12027be5b2d.zip"},"environment":{"variables":{"DYNAMODB_TABLE":{"Ref":"CoreTable97EB8292"},"S3_BUCKET":{"Ref":"AudioBucket96BEECBA"},"SECRETS_NAME":"cally/production"}},"functionName":"cally-transcription-processor","handler":"index.handler","memorySize":512,"role":{"Fn::GetAtt":["TranscriptionProcessorServiceRoleF833FEA0","Arn"]},"runtime":"nodejs20.x","timeout":900}}},"SqsEventSource:CallyStackTranscriptionQueueA87ECEF9":{"id":"SqsEventSource:CallyStackTranscriptionQueueA87ECEF9","path":"CallyStack/TranscriptionProcessor/SqsEventSource:CallyStackTranscriptionQueueA87ECEF9","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/TranscriptionProcessor/SqsEventSource:CallyStackTranscriptionQueueA87ECEF9/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":1,"eventSourceArn":{"Fn::GetAtt":["TranscriptionQueue01B856E8","Arn"]},"functionName":{"Ref":"TranscriptionProcessor12E1D9F9"}}}}}}}},"CallyUserPool":{"id":"CallyUserPool","path":"CallyStack/CallyUserPool","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPool","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/CallyUserPool/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPool","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPool","aws:cdk:cloudformation:props":{"accountRecoverySetting":{"recoveryMechanisms":[{"name":"verified_email","priority":1}]},"adminCreateUserConfig":{"allowAdminCreateUserOnly":false},"autoVerifiedAttributes":["email"],"emailVerificationMessage":"The verification code to your new account is {####}","emailVerificationSubject":"Verify your new account","policies":{"passwordPolicy":{"minimumLength":8,"requireLowercase":true,"requireUppercase":true,"requireNumbers":true,"requireSymbols":false}},"schema":[{"name":"email","mutable":true,"required":true},{"name":"name","mutable":true,"required":false}],"smsVerificationMessage":"The verification code to your new account is {####}","usernameAttributes":["email"],"userPoolName":"cally-users","verificationMessageTemplate":{"defaultEmailOption":"CONFIRM_WITH_CODE","emailMessage":"The verification code to your new account is {####}","emailSubject":"Verify your new account","smsMessage":"The verification code to your new account is {####}"}}}},"CallyCustomDomain":{"id":"CallyCustomDomain","path":"CallyStack/CallyUserPool/CallyCustomDomain","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolDomain","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/CallyUserPool/CallyCustomDomain/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolDomain","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolDomain","aws:cdk:cloudformation:props":{"customDomainConfig":{"certificateArn":"placeholder"},"domain":"signin.callygo.com","userPoolId":{"Ref":"CallyUserPool48BB3D80"}}}}}},"CallyWebClient":{"id":"CallyWebClient","path":"CallyStack/CallyUserPool/CallyWebClient","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolClient","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/CallyUserPool/CallyWebClient/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolClient","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolClient","aws:cdk:cloudformation:props":{"allowedOAuthFlows":["code"],"allowedOAuthFlowsUserPoolClient":true,"allowedOAuthScopes":["email","openid","profile"],"callbackUrLs":["http://localhost:3113/api/auth/google/callback","https://proj-cally.vercel.app/api/auth/google/callback","https://callygo.com/api/auth/google/callback","https://www.callygo.com/api/auth/google/callback","exp://localhost:8081","exp://localhost:8081/--/","exp://10.1.1.195:8081","cally-mobile://"],"clientName":"cally-web","explicitAuthFlows":["ALLOW_USER_PASSWORD_AUTH","ALLOW_USER_SRP_AUTH","ALLOW_REFRESH_TOKEN_AUTH"],"generateSecret":true,"logoutUrLs":["http://localhost:3113","https://proj-cally.vercel.app","https://callygo.com","https://www.callygo.com"],"preventUserExistenceErrors":"ENABLED","supportedIdentityProviders":["COGNITO","Google"],"userPoolId":{"Ref":"CallyUserPool48BB3D80"}}}}}}}},"CallyCognitoCertificate":{"id":"CallyCognitoCertificate","path":"CallyStack/CallyCognitoCertificate","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"GoogleProvider":{"id":"GoogleProvider","path":"CallyStack/GoogleProvider","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolIdentityProviderGoogle","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/GoogleProvider/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolIdentityProvider","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolIdentityProvider","aws:cdk:cloudformation:props":{"attributeMapping":{"email":"email","name":"name","picture":"picture"},"providerDetails":{"client_id":"{{resolve:secretsmanager:arn:aws:secretsmanager:ap-southeast-2:710735877057:secret:cally/production:SecretString:GOOGLE_CLIENT_ID::}}","client_secret":"{{resolve:secretsmanager:arn:aws:secretsmanager:ap-southeast-2:710735877057:secret:cally/production:SecretString:GOOGLE_CLIENT_SECRET::}}","authorize_scopes":"email profile openid"},"providerName":"Google","providerType":"Google","userPoolId":{"Ref":"CallyUserPool48BB3D80"}}}}}},"EmailBucket":{"id":"EmailBucket","path":"CallyStack/EmailBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.231.0","metadata":[]}},"EmailsTable":{"id":"EmailsTable","path":"CallyStack/EmailsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.TableBase","version":"2.231.0","metadata":[]}},"YogaCoreTable":{"id":"YogaCoreTable","path":"CallyStack/YogaCoreTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.TableBase","version":"2.231.0","metadata":[]}},"VercelUser":{"id":"VercelUser","path":"CallyStack/VercelUser","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.User","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/VercelUser/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnUser","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::User","aws:cdk:cloudformation:props":{"managedPolicyArns":[{"Ref":"VercelPolicy7DDA1F5D"}],"userName":"cally-vercel"}}}}},"VercelPolicy":{"id":"VercelPolicy","path":"CallyStack/VercelPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.ManagedPolicy","version":"2.231.0","metadata":[]},"children":{"ImportedVercelPolicy":{"id":"ImportedVercelPolicy","path":"CallyStack/VercelPolicy/ImportedVercelPolicy","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"CallyStack/VercelPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnManagedPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::ManagedPolicy","aws:cdk:cloudformation:props":{"description":"","managedPolicyName":"cally-vercel-policy","path":"/","policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:DeleteItem","dynamodb:GetItem","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":["arn:aws:dynamodb:ap-southeast-2:710735877057:table/yoga-go-core","arn:aws:dynamodb:ap-southeast-2:710735877057:table/yoga-go-core/index/*","arn:aws:dynamodb:ap-southeast-2:710735877057:table/yoga-go-emails","arn:aws:dynamodb:ap-southeast-2:710735877057:table/yoga-go-emails/index/*",{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},"/index/*"]]}]},{"Action":["cognito-idp:AdminGetUser","cognito-idp:DescribeUserPool","cognito-idp:DescribeUserPoolClient","cognito-idp:GetUser"],"Effect":"Allow","Resource":{"Fn::GetAtt":["CallyUserPool48BB3D80","Arn"]}},{"Action":["ses:CreateEmailIdentity","ses:DeleteEmailIdentity","ses:GetEmailIdentity","ses:PutEmailIdentityDkimAttributes","ses:PutEmailIdentityMailFromAttributes"],"Effect":"Allow","Resource":"arn:aws:ses:us-west-2:*:identity/*"},{"Action":["ses:SendEmail","ses:SendRawEmail"],"Effect":"Allow","Resource":"*"},{"Action":["s3:DeleteObject","s3:GetObject","s3:ListBucket","s3:PutObject","s3:PutObjectAcl"],"Effect":"Allow","Resource":["arn:aws:s3:::yoga-go-incoming-emails-710735877057","arn:aws:s3:::yoga-go-incoming-emails-710735877057/*",{"Fn::GetAtt":["AudioBucket96BEECBA","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AudioBucket96BEECBA","Arn"]},"/*"]]}]},{"Action":"sqs:SendMessage","Effect":"Allow","Resource":{"Fn::GetAtt":["TranscriptionQueue01B856E8","Arn"]}}],"Version":"2012-10-17"}}}}}},"YogaGoSecret":{"id":"YogaGoSecret","path":"CallyStack/YogaGoSecret","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"CallyNotificationStreamLambda":{"id":"CallyNotificationStreamLambda","path":"CallyStack/CallyNotificationStreamLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.231.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"CallyStack/CallyNotificationStreamLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.231.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"CallyStack/CallyNotificationStreamLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.231.0","metadata":[]}},"Resource":{"id":"Resource","path":"CallyStack/CallyNotificationStreamLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"CallyStack/CallyNotificationStreamLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/CallyNotificationStreamLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["CoreTable97EB8292","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:ConditionCheckItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":"arn:aws:dynamodb:ap-southeast-2:710735877057:table/yoga-go-emails"},{"Action":["secretsmanager:DescribeSecret","secretsmanager:GetSecretValue"],"Effect":"Allow","Resource":"arn:aws:secretsmanager:ap-southeast-2:710735877057:secret:yoga-go/production-??????"},{"Action":"dynamodb:ListStreams","Effect":"Allow","Resource":"*"},{"Action":["dynamodb:DescribeStream","dynamodb:GetRecords","dynamodb:GetShardIterator"],"Effect":"Allow","Resource":"placeholder"}],"Version":"2012-10-17"},"policyName":"CallyNotificationStreamLambdaServiceRoleDefaultPolicy6A78FE53","roles":[{"Ref":"CallyNotificationStreamLambdaServiceRole47A67B80"}]}}}}}}},"Code":{"id":"Code","path":"CallyStack/CallyNotificationStreamLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.231.0"},"children":{"Stage":{"id":"Stage","path":"CallyStack/CallyNotificationStreamLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.231.0"}},"AssetBucket":{"id":"AssetBucket","path":"CallyStack/CallyNotificationStreamLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.231.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"CallyStack/CallyNotificationStreamLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-710735877057-ap-southeast-2","s3Key":"99d2c81fc7cea4e6c4bfe98f7decbfd95f460ad6fb5cd1d0e3878eef8ccc2fed.zip"},"environment":{"variables":{"DYNAMODB_TABLE":{"Ref":"CoreTable97EB8292"},"SECRETS_NAME":"yoga-go/production"}},"functionName":"cally-notification-stream","handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["CallyNotificationStreamLambdaServiceRole47A67B80","Arn"]},"runtime":"nodejs20.x","timeout":30}}},"DynamoDBEventSource:CallyStackEmailsTable30D25290":{"id":"DynamoDBEventSource:CallyStackEmailsTable30D25290","path":"CallyStack/CallyNotificationStreamLambda/DynamoDBEventSource:CallyStackEmailsTable30D25290","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyStack/CallyNotificationStreamLambda/DynamoDBEventSource:CallyStackEmailsTable30D25290/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":10,"eventSourceArn":"placeholder","filterCriteria":{"filters":[{"pattern":"{\"eventName\":[\"INSERT\"],\"dynamodb\":{\"NewImage\":{\"isOutgoing\":{\"BOOL\":[false]}}}}"},{"pattern":"{\"eventName\":[\"INSERT\"],\"dynamodb\":{\"NewImage\":{\"isOutgoing\":[{\"exists\":false}]}}}"}]},"functionName":{"Ref":"CallyNotificationStreamLambda92757667"},"maximumRetryAttempts":2,"startingPosition":"LATEST"}}}}}}},"CoreTableName":{"id":"CoreTableName","path":"CallyStack/CoreTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"CoreTableArn":{"id":"CoreTableArn","path":"CallyStack/CoreTableArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"AudioBucketName":{"id":"AudioBucketName","path":"CallyStack/AudioBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"UserPoolId":{"id":"UserPoolId","path":"CallyStack/UserPoolId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"UserPoolClientId":{"id":"UserPoolClientId","path":"CallyStack/UserPoolClientId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"CognitoDomain":{"id":"CognitoDomain","path":"CallyStack/CognitoDomain","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"CognitoCloudFrontDomain":{"id":"CognitoCloudFrontDomain","path":"CallyStack/CognitoCloudFrontDomain","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"CognitoRegion":{"id":"CognitoRegion","path":"CallyStack/CognitoRegion","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"VercelUserArn":{"id":"VercelUserArn","path":"CallyStack/VercelUserArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"TranscriptionQueueUrl":{"id":"TranscriptionQueueUrl","path":"CallyStack/TranscriptionQueueUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"Note_ClientSecret":{"id":"Note_ClientSecret","path":"CallyStack/Note_ClientSecret","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"CallyStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Default":{"id":"Default","path":"CallyStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.231.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"CallyStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.231.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"CallyStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.231.0"}}}},"CallyCertStack":{"id":"CallyCertStack","path":"CallyCertStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.231.0"},"children":{"CallyCognitoCert":{"id":"CallyCognitoCert","path":"CallyCertStack/CallyCognitoCert","constructInfo":{"fqn":"aws-cdk-lib.aws_certificatemanager.Certificate","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CallyCertStack/CallyCognitoCert/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_certificatemanager.CfnCertificate","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CertificateManager::Certificate","aws:cdk:cloudformation:props":{"domainName":"signin.callygo.com","tags":[{"key":"Name","value":"cally-cognito-signin.callygo.com"}],"validationMethod":"DNS"}}}}},"CertificateArn":{"id":"CertificateArn","path":"CallyCertStack/CertificateArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"NextSteps":{"id":"NextSteps","path":"CallyCertStack/NextSteps","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"CallyCertStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Default":{"id":"Default","path":"CallyCertStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.231.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"CallyCertStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.231.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"CallyCertStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.231.0"}}}},"CognitoCertStack":{"id":"CognitoCertStack","path":"CognitoCertStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.231.0"},"children":{"CognitoCert":{"id":"CognitoCert","path":"CognitoCertStack/CognitoCert","constructInfo":{"fqn":"aws-cdk-lib.aws_certificatemanager.Certificate","version":"2.231.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CognitoCertStack/CognitoCert/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_certificatemanager.CfnCertificate","version":"2.231.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CertificateManager::Certificate","aws:cdk:cloudformation:props":{"domainName":"auth.myyoga.guru","tags":[{"key":"Name","value":"cognito-auth.myyoga.guru"}],"validationMethod":"DNS"}}}}},"CertificateArn":{"id":"CertificateArn","path":"CognitoCertStack/CertificateArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"NextSteps":{"id":"NextSteps","path":"CognitoCertStack/NextSteps","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.231.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"CognitoCertStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Default":{"id":"Default","path":"CognitoCertStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.231.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"CognitoCertStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.231.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"CognitoCertStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.231.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"}}}}}